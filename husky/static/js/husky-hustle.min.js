function clearMessage(e){e||(e=timeOut),tID=setTimeout(function(){$(".messages").empty()},e)}function showOverlay(e){tID&&clearTimeout(tID),e||(e="overlay"),$("#"+e).css("display","block"),$("#"+e).height($(document).height()),$("#message").css("color","#000000"),$("#message").css("margin-left","10px"),$("#message").css("font-weight","bold"),$("#message").html("Loading...Please Wait!")}function showOverlayTop(){$(".background-cover-top").css({display:"block",width:"100%",height:$(document).height(),opacity:0,"z-index":1050}).animate({opacity:.5,backgroundColor:"#000"})}function hideOverlay(e,t){e||(e="overlay"),$("#"+e).css("display","none"),clearMessage(t)}function showOverlayBox(e,t){isOpen!==!1&&($(e).css({display:"block",left:($(window).width()-$(e).width())/2,top:50,position:"absolute"}),t?($(".background-cover-top").css({display:"block",width:"100%",height:$(document).height()}),$(e).css({"z-index":$(e).css("z-index")+t})):$(".background-cover").css({display:"block",width:"100%",height:$(document).height()}))}function doOverlayOpen(e,t){return formID=e,e="#overlay-box-"+e,isOpen=!0,showOverlayBox(e,t),t?$(".background-cover-top").css({opacity:0}).animate({opacity:.5,backgroundColor:"#000"}):$(".background-cover").css({opacity:0}).animate({opacity:.5,backgroundColor:"#000"}),!1}function doOverlayClose(e,t){e="#overlay-box-"+e,isOpen=!1,$(e).css("display","none"),t?($(".background-cover-top").animate({opacity:0},"fast",null,function(){$(this).hide()}),$(e).css({"z-index":$(e).css("z-index")-t})):$(".background-cover").animate({opacity:0},"fast",null,function(){$(this).hide()})}function doOverlaySwap(e,t){return overlay="#overlay-box-"+e,isOpen=!1,$(overlay).css("display","none"),overlay="#overlay-box-"+t,isOpen=!0,showOverlayBox(overlay),!1}function reloadPage(){var e=window.location.href.replace("#","");window.location=e}function showFormDonate(){$("#overlay-box-add").dialog({closeOnEscape:!0,minWidth:600,minHeight:100,modal:!0,dialogClass:"tooltip",resizable:!1,close:function(){cancelForm()}})}function showFormTeacher(){$("#overlay-box-teacher").dialog({closeOnEscape:!0,minWidth:600,minHeight:100,modal:!0,dialogClass:"tooltip",resizable:!1,close:function(){cancelForm()}})}function showBarChart(e){$.getJSON("/admin/reports/"+e,initBarChart)}function showTooltip(){var e=this.id.replace("_tooltip","");$("#tooltip_"+e).dialog({closeOnEscape:!0,minWidth:500,minHeight:100,dialogClass:"tooltip",resizable:!1})}function submitForm(){var e=$(this);e.button("loading");var t=$(this).attr("id").match("submit_(\\w+)"),o=$("#"+t[1]+"_form"),a=o.serialize(),i=o.attr("action");return"invite"!==t[1]||$("#email_addresses").val()?(("reminder"===t[1]||"thanks"===t[1])&&$(".set-reminder").each(function(){"checked"===$(this).attr("checked")&&(a+="&donators="+$(this).val())}),$.ajax({url:i,type:"post",dataType:"json",data:a,timeout:35e3,complete:function(t){e.button("reset"),updateStatus(t.responseJSON)}}),!1):(alert("You must provide email addresses"),!1)}function submitDonationForm(){var e=$("#form_id_donation").val().replace(/[\$,]+/g,"");$("#form_id_donation").val(e),$("#pledge_form").submit()}function submitFormAction(){var e=this.id.replace("submit_",""),t=$("#"+e+"_form");showOverlayTop(),setTimeout(function(){t.submit()},1e3)}function submitSearchForm(){var e=this.id.replace("submit_",""),t=new RegExp("(\\w+)_(\\w+)"),o=e.match(t);o&&(e=o[2],"parent"===o[1]?($("#parent_only").val(1),$("#student_last_name").val(""),$("#student_first_name").val("")):($("#parent_only").val(0),$("#parent_last_name").val(""),$("#parent_first_name").val(""))),showOverlayTop(),setTimeout(function(){$("#form_"+e).submit()},1e3)}function cancelOverlay(e){var t;t=null===e?e.keyCode:e.which,27===t&&(formID.match("_form")?$("#"+formID+" .cancel_button").trigger("click"):"edit"===formID?$(".form-"+formID+" .cancel_button").trigger("click"):$("#"+formID+"_form .cancel_button").trigger("click"),cancelForm(formID,formID),formID="")}function cancelForm(){var e,t=$(this).attr("id");if(t&&"object"!=typeof t)if(doOverlayClose(t),"cancel_child"===t||"cancel_profile"===t)$(".form-edit").hide();else if("cancel_sponsor"===t){var o=$("#id").val();$("#sponsor").hide(),$("#sponsor input").each(function(){if(this.id){var e=$("#row"+o+' td[abbr="'+this.id+'"]').text();"per_lap"===this.id?$(this).attr("checked",!1):e&&$(this).attr("value","")}})}else e=t.replace("cancel_",""),$("#"+e+"_form").hide();else t&&"object"==typeof t&&"id"===t.name?$(".input-field").each(function(){$(this).attr("value","")}):this.id&&"object"!=typeof this.id&&(e=this.id.replace("cancel_",""),$("#"+e+"_form").hide())}function updatePage(e){updateStatus(e),200==e.status&&(cancelFormDetails(e.form),path="/admin/index",path+="/limit/"+($("#limit").val()?$("#limit").val():"10"),path+="/offset/"+($("#offset").val()?$("#offset").val():"0"),setTimeout(function(){top.location.href=path},1200))}function updateStatus(e){tID&&clearTimeout(tID);var t=$(".messages");200!=e.status?t.css("color","red"):t.css("color","green"),e.is_modal&&$("#"+e.is_modal).modal("hide"),t.append("<li>"+e.message+"</li>"),clearMessage()}function updateReload(e){updateStatus(e),setTimeout(function(){top.location.href=path},1200)}function setAllReminders(){var e=$(this).attr("checked");$(".set-reminder").each(function(){$(this).attr("checked",e?!0:!1)})}function setPreSetAmount(){var e=$(this).val();this.className.match("to-teacher")?(e=$("#id_teacher :selected").val(),$("#id_first_name").attr("value",e)):e?($("#id_donation").attr("value",e),$("#id_donation").attr("readonly",!0)):($("#id_donation").attr("value",""),$("#id_donation").attr("readonly",!1))}function makeDonation(e){var t=e.id.match("payment-([\\w-]+)")[1];$("#donation_form").attr("action",e.getAttribute("action")),$("#donation_id").val(t),$("#donation_title").text("Make a Payment to "+$("#student-"+e.id).text())}function sendReminder(e){var t=e.id.match("reminder-([\\w-]+)")[1];$("#reminder_form").attr("action",e.getAttribute("action")),$("#reminder_title").text("Send a Reminder to "+$("#student-"+t).text()+"'s Sponsors ")}function disconnectSocial(){return $.getJSON($(this).attr("src"),reloadPage),!1}function runCalculations(){return doOverlayOpen("none",50),$.getJSON($(this).attr("href"),reloadPage),!1}function postToSocial(){window.open($(this).attr("src"),"_social","height=200,width=550,resizable=yes,scrollbars=yes")}function selectAllItems(){var e=$(".select-all-label").hasClass("active");$(".remove-item").each(function(){this.checked=e?!1:!0})}function removeCartItems(){var e=$("#cart_form").attr("action"),t=function(o){var a=$.Deferred();return $.ajax({url:e+o,type:"get",dataType:"json",timeout:3e3,complete:function(){a.resolve()},error:function(){t(o)}}),a.promise()},o=[];return $(".remove-item").each(function(){this.checked&&o.push(t(this.id))}),$.when.apply($,o).done(reloadPage),!1}function initBarChart(e){var t=new $jit.BarChart({injectInto:"infovis",animate:!0,orientation:"vertical",barsOffset:20,Margin:{top:5,left:5,right:5,bottom:5},labelOffset:5,type:useGradients?"stacked:gradient":"stacked",showAggregates:!0,showLabels:!0,Label:{type:labelType,size:13,family:"Arial",color:"white"},Tips:{enable:!0,onShow:function(e,t){e.innerHTML="<b>"+t.name+"</b>: "+t.value}},Events:{enable:!0,onClick:function(e){url="/admin/results/donations-by-teacher?id="+e.label,e.label&&(window.location.href.match("most-donations-by-child\\?id=0")&&e.label?(url="/admin/results/most-donations-by-child?id="+e.label,window.parent.location=url):window.location.href.match("donations-by-teacher\\?id=0")&&e.label?window.parent.location=url:window.location.href.match("donations-by-teacher\\?id=\\d+")&&(window.parent.location="/admin/results/donations-by-teacher"))}}});t.loadJSON(e)}function _console_log(e){console&&console.log&&console.log("Sample of data:",e)}var labelType,useGradients,nativeTextSupport,animate,noAlert=!0,isOpen=!1,timeOut=12e3,formID="",tID="";$(".submit-form").bind("click",submitForm),$(".post-to-social").bind("click",postToSocial),$(".pre-set-amount").bind("change",setPreSetAmount),$(".to-teacher").bind("change",setPreSetAmount),$(".remove-items").bind("click",removeCartItems),$(".select-all-items").bind("change",selectAllItems),$("#submit_donation").bind("click",submitDonationForm),$("#modal-box-donation").on("show.bs.modal",function(e){makeDonation(e.relatedTarget)}),$("#modal-box-reminder").on("show.bs.modal",function(e){sendReminder(e.relatedTarget)}),function(){var e=navigator.userAgent,t=e.match(/iPhone/i)||e.match(/iPad/i),o=typeof HTMLCanvasElement,a="object"===o||"function"===o,i=a&&"function"==typeof document.createElement("canvas").getContext("2d").fillText;labelType=!a||i&&!t?"Native":"HTML",nativeTextSupport="Native"===labelType,useGradients=a,animate=!(t||!a)}();